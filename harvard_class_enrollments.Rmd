---
title: "An Analysis of Harvard Class Enrollment Over Time"
author: "Taehwan Kim"
date: "4/6/2019"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = FALSE, cache = TRUE)

# Load in libraries
library(fs)
library(readxl)
library(janitor)
library(tidyverse)

# Download enrollment data
download.file(url = "https://registrar.fas.harvard.edu/files/fas-registrar/files/class_enrollment_summary_by_term_3.22.19.xlsx",
              destfile = "enroll_19.xlsx",
              mode = "wb")

download.file(url = "https://registrar.fas.harvard.edu/files/fas-registrar/files/class_enrollment_summary_by_term_03.06.18.xlsx",
              destfile = "enroll_18.xlsx",
              mode = "wb")

# Read in enrollment statistics to environment
enrollment_2019 <- read_xlsx("enroll_19.xlsx", skip = 3) %>% 
  clean_names(case = "snake") %>%
  filter(!is.na(course_name))

enrollment_2018 <- read_xlsx("enroll_18.xlsx", skip = 3) %>% 
  clean_names(case = "snake") %>% 
  filter(!is.na(course_name))

# Delete downloaded files
fs::file_delete(c("enroll_19.xlsx","enroll_18.xlsx"))
```

